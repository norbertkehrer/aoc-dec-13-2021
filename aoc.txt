100 rem *** advent  of  code  ***
110 rem *** december 13, 2021 ***
130 rem
140 rem adventofcode.com/2021/day/13
150 rem
160 rem by norbert kehrer
170 rem norbertkehrer.github.io
180 rem

200 print
210 print "advent of code on december 13, 2021"
220 print "==================================="
230 print
240 ti$="000000":rem reset timer

500 dim dx%(1000):rem dots x-coo
510 dim dy%(1000):rem dots y-coo
520 nd = 0:rem number of dots
530 mx=0:my=0:rem maximum x and y

1000 rem read input dots
1010 nd=0:mx=0:my=0
1020 read x:read y
1030 if x<0 then 2000
1040 nd=nd+1:dx%(nd)=x:dy%(nd)=y
1050 if x>mx then mx=x
1060 if y>my then my=y
1070 goto 1020

2000 rem read and execute fold instructions
2010 pt=1:rem part 1
2020 read co$:read v
2030 if v<0 then 4000
2040 if co$<>"x" then 2110

2050 for i=1 to nd
2060 if dx%(i)<v then 2080
2070 dx%(i)=v-(dx%(i)-v)
2080 next i
2090 mx=v-1
2100 goto 2200

2110 for i=1 to nd
2120 if dy%(i)<v then 2140
2130 dy%(i)=v-(dy%(i)-v)
2140 next i
2150 my=v-1

2200 if pt=1 then pt=2:gosub 10000:rem print part 1 result

2210 goto 2020

4000 rem part 2 answer
4010 dim im%(mx+1,my+1):ch$(1)=".":ch$(2)=chr$(18)+" "+chr$(146)
4011 print mx,my
4020 for i=1 to nd
4030 if dx%(i)<=mx and dy%(i)<=my then im%(dx%(i)+1,dy%(i)+1)=1
4040 next i
4050 print "part 2:"
4060 print
4100 for i=1 to my+1
4110 for j=1 to mx+1
4120 print ch$(im%(j,i)+1);
4130 next j
4140 rem print
4150 next i
4160 print

5000 rem
5200 print
5210 print "time needed (hours:minutes): ";left$(ti$,2);":";mid$(ti$,3,2)
5220 print
5230 print "norbert kehrer"
5240 print "github.com/norbertkehrer/aoc-dec-13-2021"
5300 end

10000 rem print part 1 result
10010 vi=0
10020 for j=1 to nd
10030 if dx%(j)>mx or dy%(j)>my then 10100
10040 ex=0
10050 for k=j+1 to nd
10060 if dx%(k)>mx or dy%(k)>my then 10080
10070 if dx%(k)=dx%(j) and dy%(k)=dy%(j) then ex=1:k=nd+1
10080 next k
10090 if ex=0 then vi=vi+1
10100 next j
10110 print "part 1:";vi;" visible dots."
10120 return

60000 rem insert your data set here
60010 data 462,575
60011 data 1293,547
60012 data 560,735
60013 data 441,425
60014 data 261,824
60015 data 425,716
60016 data 1133,106
60017 data 49,705
60018 data 666,563
60019 data 1091,393
60020 data 529,845
60021 data 192,703
60022 data 637,557
60023 data 37,586
60024 data 621,423
60025 data 986,205
60026 data 748,5
60027 data 1076,450
60028 data 13,452
60029 data 120,585
60030 data 770,324
60031 data 157,344
60032 data 708,86
60033 data 855,689
60034 data 1116,206
60035 data 683,845
60036 data 627,845
60037 data 460,438
60038 data 910,239
60039 data 420,546
60040 data 965,127
60041 data 1258,658
60042 data 808,86
60043 data 1165,179
60044 data 345,421
60045 data 595,378
60046 data 1290,409
60047 data 345,127
60048 data 810,772
60049 data 184,285
60050 data 808,808
60051 data 154,122
60052 data 102,324
60053 data 1218,341
60054 data 505,666
60055 data 748,31
60056 data 308,553
60057 data 1022,764
60058 data 1253,698
60059 data 1014,464
60060 data 1021,35
60061 data 1265,563
60062 data 306,833
60063 data 470,465
60064 data 242,17
60065 data 1014,318
60066 data 1273,187
60067 data 1299,696
60068 data 172,576
60069 data 1200,360
60070 data 392,710
60071 data 154,766
60072 data 388,157
60073 data 59,702
60074 data 371,367
60075 data 1022,130
60076 data 1151,651
60077 data 185,19
60078 data 60,402
60079 data 309,547
60080 data 1087,180
60081 data 1136,86
60082 data 1091,852
60083 data 272,651
60084 data 1158,767
60085 data 962,485
60086 data 693,35
60087 data 810,324
60088 data 303,334
60089 data 289,245
60090 data 195,114
60091 data 992,794
60092 data 830,693
60093 data 90,508
60094 data 1238,43
60095 data 950,824
60096 data 360,789
60097 data 1074,45
60098 data 1261,14
60099 data 234,641
60100 data 853,577
60101 data 788,113
60102 data 564,640
60103 data 1129,795
60104 data 244,743
60105 data 431,404
60106 data 1141,568
60107 data 830,584
60108 data 869,21
60109 data 132,392
60110 data 1054,415
60111 data 991,19
60112 data 1039,505
60113 data 1032,716
60114 data 1126,609
60115 data 597,868
60116 data 412,17
60117 data 82,289
60118 data 1109,611
60119 data 1277,423
60120 data 1094,310
60121 data 455,205
60122 data 879,404
60123 data 221,537
60124 data 410,308
60125 data 835,232
60126 data 380,758
60127 data 1049,669
60128 data 889,476
60129 data 840,410
60130 data 63,801
60131 data 1156,430
60132 data 900,586
60133 data 1052,150
60134 data 398,535
60135 data 644,563
60136 data 788,688
60137 data 810,570
60138 data 609,331
60139 data 1014,800
60140 data 490,642
60141 data 1273,138
60142 data 1148,285
60143 data 480,534
60144 data 420,796
60145 data 45,787
60146 data 421,663
60147 data 254,498
60148 data 187,383
60149 data 1022,511
60150 data 371,143
60151 data 716,492
60152 data 192,863
60153 data 1220,254
60154 data 576,774
60155 data 786,460
60156 data 90,386
60157 data 57,266
60158 data 1062,568
60159 data 162,492
60160 data 383,837
60161 data 1178,654
60162 data 874,579
60163 data 154,576
60164 data 370,231
60165 data 340,520
60166 data 830,23
60167 data 705,425
60168 data 803,128
60169 data 433,378
60170 data 972,77
60171 data 90,366
60172 data 1159,472
60173 data 1295,680
60174 data 626,858
60175 data 303,560
60176 data 1195,326
60177 data 293,759
60178 data 132,8
60179 data 768,102
60180 data 910,463
60181 data 488,233
60182 data 877,537
60183 data 1290,285
60184 data 1007,96
60185 data 420,775
60186 data 462,191
60187 data 914,598
60188 data 1125,248
60189 data 1021,245
60190 data 843,677
60191 data 1125,646
60192 data 536,504
60193 data 17,547
60194 data 885,716
60195 data 1211,452
60196 data 562,863
60197 data 791,329
60198 data 370,651
60199 data 480,667
60200 data 90,106
60201 data 219,841
60202 data 1216,159
60203 data 914,296
60204 data 562,612
60205 data 910,655
60206 data 299,341
60207 data 185,248
60208 data 358,616
60209 data 515,665
60210 data 679,320
60211 data 619,669
60212 data 982,116
60213 data 667,366
60214 data 910,172
60215 data 913,700
60216 data 746,386
60217 data 174,86
60218 data 828,122
60219 data 1278,824
60220 data 118,168
60221 data 457,317
60222 data 309,25
60223 data 256,791
60224 data 87,46
60225 data 726,889
60226 data 172,401
60227 data 797,467
60228 data 972,758
60229 data 1241,700
60230 data 544,534
60231 data 70,556
60232 data 1071,400
60233 data 441,469
60234 data 191,721
60235 data 1099,387
60236 data 42,679
60237 data 433,68
60238 data 289,649
60239 data 219,42
60240 data 939,639
60241 data 1041,266
60242 data 1300,705
60243 data 500,401
60244 data 1081,402
60245 data 1168,17
60246 data 27,49
60247 data 806,646
60248 data 443,277
60249 data 711,260
60250 data 711,617
60251 data 843,5
60252 data 397,28
60253 data 197,317
60254 data 1175,329
60255 data 120,309
60256 data 324,205
60257 data 803,688
60258 data 547,729
60259 data 1021,49
60260 data 194,591
60261 data 177,323
60262 data 522,662
60263 data 318,100
60264 data 457,410
60265 data 1171,782
60266 data 223,180
60267 data 959,357
60268 data 273,665
60269 data 15,886
60270 data 959,89
60271 data 234,761
60272 data 949,837
60273 data 709,61
60274 data 917,376
60275 data 277,189
60276 data 59,726
60277 data 507,438
60278 data 208,56
60279 data 952,616
60280 data 358,800
60281 data 1115,114
60282 data 1218,388
60283 data 488,653
60284 data 999,240
60285 data 315,590
60286 data 930,787
60287 data 229,44
60288 data 962,149
60289 data 303,308
60290 data 1267,751
60291 data 666,555
60292 data 947,256
60293 data 759,728
60294 data 1020,166
60295 data 818,161
60296 data 176,150
60297 data 365,201
60298 data 69,28
60299 data 1253,404
60300 data 398,434
60301 data 236,177
60302 data 1230,549
60303 data 290,166
60304 data 616,667
60305 data 698,679
60306 data 599,53
60307 data 617,586
60308 data 1293,347
60309 data 107,184
60310 data 49,14
60311 data 522,232
60312 data 507,791
60313 data 1054,255
60314 data 750,607
60315 data 1037,217
60316 data 257,194
60317 data 1138,625
60318 data 1250,492
60319 data 1077,418
60320 data 1053,866
60321 data 242,877
60322 data 172,269
60323 data 1111,422
60324 data 294,822
60325 data 960,640
60326 data 738,605
60327 data 196,684
60328 data 412,701
60329 data 1134,744
60330 data 539,171
60331 data 929,173
60332 data 273,217
60333 data 584,777
60334 data 395,498
60335 data 1275,449
60336 data 870,120
60337 data 470,410
60338 data 1036,115
60339 data 393,152
60340 data 937,563
60341 data 1094,624
60342 data 25,807
60343 data 594,402
60344 data 633,63
60345 data 972,563
60346 data 1016,789
60347 data 965,767
60348 data 206,189
60349 data 174,3
60350 data 759,812
60351 data 774,390
60352 data 869,873
60353 data 174,808
60354 data 952,128
60355 data 181,627
60356 data 755,578
60357 data 109,397
60358 data 218,315
60359 data 582,478
60360 data 244,744
60361 data 28,708
60362 data 1146,642
60363 data 446,838
60364 data 277,705
60365 data 472,882
60366 data 1203,710
60367 data 869,469
60368 data 324,689
60369 data 992,100
60370 data 293,241
60371 data 798,297
60372 data 1293,109
60373 data 1098,770
60374 data 502,879
60375 data 631,320
60376 data 500,464
60377 data 239,400
60378 data 1113,634
60379 data 482,576
60380 data 783,689
60381 data 1066,743
60382 data 705,469
60383 data 1043,702
60384 data 1240,301
60385 data 1300,339
60386 data 523,332
60387 data 1052,271
60388 data 1150,529
60389 data 734,344
60390 data 987,418
60391 data 151,24
60392 data 396,598
60393 data 842,640
60394 data 92,770
60395 data 1299,472
60396 data 895,848
60397 data 160,365
60398 data 452,130
60399 data 510,553
60400 data 366,764
60401 data 952,94
60402 data 497,550
60403 data 507,688
60404 data 780,159
60405 data 523,285
60406 data 890,796
60407 data 222,126
60408 data 290,728
60409 data 1038,747
60410 data 400,844
60411 data 387,740
60412 data 1220,834
60413 data 769,201
60414 data 1074,177
60415 data 962,385
60416 data 52,563
60417 data 1081,850
60418 data 17,557
60419 data 160,877
60420 data 585,28
60421 data 1028,145
60422 data 781,49
60423 data 541,201
60424 data 808,127
60425 data 184,609
60426 data 691,163
60427 data 736,875
60428 data 366,831
60429 data 823,203
60430 data 139,782
60431 data 380,422
60432 data 868,210
60433 data 818,385
60434 data 150,840
60435 data 984,642
60436 data 356,239
60437 data 147,8
60438 data 579,46
60439 data 408,698
60440 data 1300,555
60441 data 355,173
60442 data 1066,744
60443 data 969,429
60444 data 864,838
60445 data 229,850
60446 data 713,868
60447 data 201,283
60448 data 412,877
60449 data 643,646
60450 data 1044,381
60451 data 42,215
60452 data 232,383
60453 data 852,210
60454 data 900,157
60455 data 57,420
60456 data 803,662
60457 data 509,669
60458 data 1081,619
60459 data 666,369
60460 data 1007,560
60461 data 356,59
60462 data 1086,857
60463 data 254,851
60464 data 500,548
60465 data 281,779
60466 data 1113,577
60467 data 512,297
60468 data 358,278
60469 data 441,320
60470 data 551,728
60471 data 711,277
60472 data 356,507
60473 data 164,642
60474 data 457,577
60475 data 667,198
60476 data 467,453
60477 data 1007,287
60478 data 442,322
60479 data 808,564
60480 data 400,396
60481 data 236,190
60482 data 758,435
60483 data 673,557
60484 data 1242,240
60485 data 590,184
60486 data 48,124
60487 data 952,352
60488 data 1094,584
60489 data 806,16
60490 data 883,452
60491 data 348,205
60492 data 1186,735
60493 data 922,140
60494 data 955,721
60495 data 584,5
60496 data 759,166
60497 data 276,413
60498 data 1076,892
60499 data 299,385
60500 data 940,231
60501 data 160,529
60502 data 981,366
60503 data 1247,93
60504 data 619,445
60505 data 145,764
60506 data 141,427
60507 data 10,563
60508 data 1203,184
60509 data 519,497
60510 data 1001,421
60511 data 234,450
60512 data 929,721
60513 data 211,387
60514 data 1136,534
60515 data 1091,53
60516 data 1005,826
60517 data 1089,537
60518 data 308,341
60519 data 1161,795
60520 data 551,812
60521 data 934,770
60522 data 759,714
60523 data 962,409
60524 data 830,871
60525 data 1038,651
60526 data 1298,128
60527 data 82,243
60528 data 99,452
60529 data 150,16
60530 data 832,150
60531 data 830,63
60532 data 1160,486
60533 data 858,764
60534 data 894,453
60535 data 522,654
60536 data 944,77
60537 data 688,70
60538 data 132,662
60539 data 20,689
60540 data 55,505
60541 data 1014,430
60542 data 92,813
60543 data 1091,841
60544 data 726,749
60545 data 420,343
60546 data 551,714
60547 data 1118,863
60548 data 418,640
60549 data 1088,691
60550 data 1017,653
60551 data 1111,870
60552 data 898,365
60553 data 53,833
60554 data 1165,225
60555 data 132,367
60556 data 999,680
60557 data 1160,296
60558 data 1011,341
60559 data 192,260
60560 data 885,850
60561 data 808,106
60562 data 1087,728
60563 data 410,157
60564 data 1007,308
60565 data 791,777
60566 data 32,70
60567 data 1171,138
60568 data 1241,7
60569 data 1037,173
60570 data 928,243
60571 data 502,127
60572 data 363,333
60573 data 892,269
60574 data 92,889
60575 data 467,159
60576 data 150,408
60577 data 431,714
60578 data 349,378
60579 data 155,306
60580 data 962,689
60581 data 371,255
60582 data 746,640
60583 data 512,578
60584 data 1056,43
60585 data 269,628
60586 data 110,360
60587 data 1131,654
60588 data 480,63
60589 data 256,415
60590 data 523,609
60591 data 917,611
60592 data 1124,651
60593 data 388,829
60594 data 1158,127
60595 data 539,540
60596 data 1190,219
60597 data 1119,721
60598 data 382,243
60599 data 599,277
60600 data 311,240
60601 data 256,551
60602 data 256,191
60603 data 1131,775
60604 data 480,693
60605 data 1032,178
60606 data 1275,669
60607 data 271,505
60608 data 120,231
60609 data 90,528
60610 data 105,565
60611 data 415,848
60612 data 482,122
60613 data 1273,586
60614 data 705,880
60615 data 827,588
60616 data 708,331
60617 data 705,462
60618 data 813,344
60619 data 10,555
60620 data 864,614
60621 data 1020,728
60622 data 457,260
60623 data 1014,662
60624 data 262,710
60625 data 502,564
60626 data 187,96
60627 data 611,191
60628 data 197,577
60629 data 1176,255
60630 data 1108,607
60631 data 626,484
60632 data 776,579
60633 data 507,128
60634 data 520,736
60635 data 972,331
60636 data 311,214
60637 data 890,31
60638 data 1034,413
60639 data 1054,236
60640 data 49,257
60641 data 801,893
60642 data 677,383
60643 data 907,680
60644 data 582,431
60645 data 1240,106
60646 data 922,754
60647 data 244,308
60648 data 1056,330
60649 data 303,565
60650 data 1128,882
60651 data 500,576
60652 data 805,795
60653 data 1028,749
60654 data 555,578
60655 data 520,611
60656 data 584,749
60657 data 1150,437
60658 data 1220,508
60659 data 599,389
60660 data 370,203
60661 data 541,96
60662 data 388,140
60663 data 1108,578
60664 data 770,570
60665 data 363,449
60666 data 1238,431
60667 data 149,795
60668 data 1160,248
60669 data 1310,604
60670 data 945,35
60671 data 1126,161
60672 data 1124,30
60673 data 595,516
60674 data 923,702
60675 data 1088,574
60676 data 803,318
60677 data 788,527
60678 data 345,473
60679 data 1158,106
60680 data 90,254
60681 data 840,484
60682 data 939,255
60683 data 1190,309
60684 data 769,693
60685 data 348,689
60686 data 234,431
60687 data 1186,579
60688 data 974,794
60689 data 1190,585
60690 data 1017,759
60691 data 851,562
60692 data 774,504
60693 data 405,651
60694 data 246,849
60695 data 224,435
60696 data 1136,511
60697 data 728,478
60698 data 605,880
60699 data 1126,18
60700 data 769,96
60701 data 505,795
60702 data 944,831
60703 data 1275,445
60704 data 179,775
60705 data 912,191
60706 data 1017,241
60707 data 1054,191
60708 data 1228,289
60709 data 1049,824
60710 data 435,42
60711 data 185,646
60712 data 770,772
60713 data 522,54
60714 data 810,464
60715 data 1126,733
60716 data 33,535
60717 data 549,117
60718 data 258,598
60719 data 830,511
60720 data 560,607
60721 data 698,428
60722 data 1099,501
60723 data 289,49
60724 data 469,26
60725 data 534,137
60726 data 940,203
60727 data 791,117
60728 data 912,133
60729 data 898,465
60730 data 278,770
60731 data 42,663
60732 data 929,665
60733 data 345,767
60734 data 1118,611
60735 data 668,240
60736 data 500,16
60737 data 356,835
60738 data 622,553
60739 data 30,728
60740 data 683,49
60741 data 480,310
60742 data 851,556
60743 data 185,868
60744 data 343,438
60745 data 1118,283
60746 data 216,24
60747 data 170,453
60748 data 522,688
60749 data 48,322
60750 data 724,150
60751 data 1261,432
60752 data 256,639
60753 data 92,388
60754 data 441,21
60755 data 339,696
60756 data 1300,257
60757 data 913,28
60758 data 1216,831
60759 data 157,550
60760 data 1078,511
60761 data 708,584
60762 data 372,749
60763 data 416,453
60764 data 1190,579
60765 data 1138,401
60766 data 913,562
60767 data 114,44
60768 data 890,282
60769 data 363,256
60770 data 912,775
60771 data 1258,534
60772 data 980,793
60773 data 1176,639
60774 data 266,795
60775 data 917,152
60776 data 488,661
60777 data 432,574
60778 data 236,717
60779 data 1293,465
60780 data 1016,822
60781 data 363,445
60782 data 1047,443
60783 data 381,665
60784 data 124,831
60785 data 1134,150
60786 data 671,438
60787 data 740,477
60788 data 830,310
60789 data 1190,427
60790 data 184,876
60791 data 162,733
60792 data 1273,859
60793 data 642,128
60794 data 1009,311
60795 data 564,386
60796 data 398,133
60797 data 835,119
60798 data 534,427
60799 data 1280,166
60800 data 113,96
60801 data 622,70
60802 data 642,240
60803 data 1102,838
60804 data 536,145
60805 data 869,320
60806 data 254,43
60807 data 1053,700
60808 data 90,0
60809 data 279,709
60810 data 358,318
60811 data 60,157
60812 data 959,565
60813 data 673,773
60814 data 162,228
60815 data 858,130
60816 data 833,323
60817 data 477,123
60818 data 17,785
60819 data 1240,556
60820 data 644,369
60821 data 1007,112
60822 data 520,606
60823 data 493,304
60824 data 930,154
60825 data 507,567
60826 data 708,563
60827 data 689,807
60828 data 157,120
60829 data 987,476
60830 data 1196,850
60831 data 1156,766
60832 data 10,787
60833 data 1144,661
60834 data 599,617
60835 data 420,450
60836 data 208,838
60837 data 256,684
60838 data 13,218
60839 data 494,877
60840 data 162,442
60841 data 20,289
60842 data 801,715
60843 data 487,203
60844 data 788,232
60845 data 551,166
60846 data 11,472
60847 data 154,772
60848 data 534,467
60849 data 1068,529
60850 data 890,431
60851 data 477,771
60852 data 1056,526
60853 data 326,252
60854 data 783,653
60855 data 1028,726
60856 data 492,812
60857 data 186,651
60858 data 621,535
60859 data 534,757
60860 data 216,270
60861 data 1123,511
60862 data 1123,798
60863 data 422,856
60864 data 900,138
60865 data 1017,87
60866 data 1021,649
60867 data 971,696
60868 data 878,203
60869 data 432,126
60870 data 45,107
60871 data 1026,427
60872 data 492,161
60873 data 790,736
60874 data 552,530
60875 data 1098,12
60876 data 212,770
60877 data 256,255
60878 data 408,45
60879 data 1190,189
60880 data 612,428
60881 data 57,474
60882 data 1148,666
60883 data 398,313
60884 data 617,756
60885 data 433,516
60886 data 684,484
60887 data 512,597
60888 data 1165,681
60889 data 694,667
60890 data 459,562
60891 data 1053,194
60892 data 257,866
60893 data 748,282
60894 data 32,824
60895 data 283,367
60896 data 1138,766
60897 data 219,53
60898 data 238,889
60899 data 985,366
60900 data 821,590
60901 data 202,607
60902 data 1268,679
60903 data 70,301
60904 data 918,710
60905 data 194,206
60906 data 689,87
60907 data 944,817
60908 data 830,463
60909 data 788,54
60910 data 432,768
60911 data 1190,227
60912 data 1104,579
60913 data 830,808
60914 data 97,824
60915 data 393,669
60916 data 564,508
60917 data 616,227
60918 data 676,485
60919 data 49,432
60920 data 296,662
60921 data 1019,1
60922 data 1007,586
60923 data 1125,870
60924 data 132,654
60925 data 446,504
60926 data 1261,462
60927 data 1019,893
60928 data 412,465
60929 data 961,516
60930 data 837,877
60931 data 808,779
60932 data 818,609
60933 data 305,826
60934 data 1253,490
60935 data 63,452
60936 data 1253,266
60937 data 1287,320
60938 data 808,63
60939 data 1218,813
60940 data 1014,232
60941 data 338,563
60942 data 293,653
60943 data 171,362
60944 data 1202,763
60945 data 244,586
60946 data 1158,107
60947 data 919,3
60948 data 380,154
60949 data 1004,205
60950 data 1178,240
60951 data 1218,506
60952 data 288,578
60953 data 746,672
60954 data 278,178
60955 data 788,654
60956 data 1116,303
60957 data 1190,705
60958 data 867,277
60959 data 1178,232
60960 data 162,161
60961 data 694,675
60962 data -1,-1

61000 data x,655
61001 data y,447
61002 data x,327
61003 data y,223
61004 data x,163
61005 data y,111
61006 data x,81
61007 data y,55
61008 data x,40
61009 data y,27
61010 data y,13
61011 data y,6
61012 data n,-1

